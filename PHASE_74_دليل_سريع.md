# ุงููุฑุญูุฉ 74: ูุธุงู Agent-Driven Development โ

## ูุธุฑุฉ ุณุฑูุนุฉ
ูุธุงู ูุงูู ููุชุทููุฑ ุจูุณุงุนุฏุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู - ุงููุณุชุฎุฏู ููุชุจ ูุชุทูุจุงุชู ูู ุงูุดุงุชุ ูุงูู Agent ูุญูููุง ุชููุงุฆูุงู ูู Phases ู Tasks ูู Firestore!

**ุงูุชุงุฑูุฎ**: 2025-11-13
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
**ุงูุณูุฑูุฑ**: http://localhost:3030

---

## ุงูุจุฏุงูุฉ ุงูุณุฑูุนุฉ (3 ุฎุทูุงุช)

### 1. ุชุฃูุฏ ุฃู ุงูุฎุฏูุงุช ุดุบุงูุฉ
```bash
# Firestore Emulator (ุงูููุฑูุถ ุดุบุงู)
firebase emulators:start --only firestore

# Dev Server (ุงูููุฑูุถ ุดุบุงู ุนูู 3030)
PORT=3030 pnpm dev
```

### 2. ุดุบูู ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ
```bash
./test-agent-chat.sh
```

### 3. ุงูุชุญ ุงููุชุตูุญ
```
http://localhost:3030/ar/projects/test-project-1
```

---

## ุงููู ุดุบุงู โ

### 1. ูุธุงู Agent
- โ ูุงุฌูุฉ ููุญุฏุฉ ููุฐูุงุก ุงูุงุตุทูุงุนู
- โ ุงุณุชุฎุฑุงุฌ Phases ุชููุงุฆูุงู ูู ุงููุต
- โ ุชูููุฏ Tasks ููู Phase
- โ ูุฒุงููุฉ ูุน Firestore
- โ ุชุณุฌูู ูู ุงูุนูููุงุช (Activity Log)

### 2. ูุงุฌูุฉ ุงูุดุงุช
- โ ChatPanel ูุงูู ูุน ุฑุฏูุฏ ุงูู Agent
- โ ChatInput ุจุชูุฏุฏ ุชููุงุฆู
- โ Enter ููุฅุฑุณุงูุ Shift+Enter ูุณุทุฑ ุฌุฏูุฏ
- โ ุญุงูุฉ ุงูุชุญููู (loading state)

### 3. ุงูุชูุงูู ูุน Firestore
- โ Subcollections: phases, tasks, activity
- โ Security Rules ูุญุฏูุซุฉ
- โ ูุฒุงููุฉ ููุฑูุฉ

---

## ููู ุชุณุชุฎุฏููุ

### ูุซุงู: ุฅูุดุงุก ูุดุฑูุน ูุชุฌุฑ ุฅููุชุฑููู

**1. ุงูุชุญ ุงูุตูุญุฉ:**
```
http://localhost:3030/ar/projects/test-project-1
```

**2. ุงูุชุจ ูู ุงูุดุงุช:**
```
ุฃูุดุฆ ูุชุฌุฑ ุฅููุชุฑููู ุจุงููุฑุงุญู ุงูุชุงููุฉ:
1) ุงูุฅุนุฏุงุฏ ูุงููุตุงุฏูุฉ
2) ูุชุงููุฌ ุงูููุชุฌุงุช
3) ุณูุฉ ุงูุชุณูู
```

**3. ุงุถุบุท Enter**

**4. ุงูู Agent ููููู ุจู:**
- โ ุชุญููู ุงูุฑุณุงูุฉ
- โ ุงุณุชุฎุฑุงุฌ 3 ูุฑุงุญู
- โ ุฅูุดุงุก Tasks ููู ูุฑุญูุฉ
- โ ุญูุธ ูู ุดูุก ูู Firestore

**5. ุชุญูู ูู Firestore:**
```
http://localhost:4000/firestore
```
ุฑูุญ ุนูู:
- `projects/test-project-1/phases` โ ูุชูุงูู 3 ูุฑุงุญู
- `projects/test-project-1/tasks` โ ูุชูุงูู ุงูููุงู
- `projects/test-project-1/activity` โ ูุชูุงูู ุณุฌู ุงูุนูููุงุช

---

## ุจููุฉ ุงููููุงุช

```
src/
โโโ types/
โ   โโโ project.ts                  โ ุฃููุงุน ุงูุจูุงูุงุช
โโโ lib/
โ   โโโ agents/
โ       โโโ index.ts                โ ูุงุฌูุฉ ุงูู Agent
โ       โโโ phaseParser.ts          โ ุงุณุชุฎุฑุงุฌ ุงููุฑุงุญู
โ       โโโ taskSync.ts             โ ุงููุฒุงููุฉ ูุน Firestore
โ       โโโ activity.ts             โ ุชุณุฌูู ุงูุนูููุงุช
โโโ features/
โ   โโโ chat/
โ   โ   โโโ ChatPanel.tsx           โ ูุงุฌูุฉ ุงูุดุงุช
โ   โ   โโโ ChatInput.tsx           โ ุญูู ุงูุฅุฏุฎุงู
โ   โ   โโโ useChatAgent.ts         โ Hook ุงูุดุงุช
โ   โโโ tasks/
โ       โโโ usePhaseProgress.ts     โ ูุชุงุจุนุฉ ุงูุชูุฏู
โโโ app/
    โโโ api/
        โโโ chat/
            โโโ route.ts            โ API ุงูุดุงุช
```

---

## ููู ูุดุชุบูุ

### 1. ุชุฏูู ุงูุฑุณุงูุฉ
```
ุงููุณุชุฎุฏู ููุชุจ ุฑุณุงูุฉ
        โ
    ChatPanel
        โ
  useChatAgent
        โ
   /api/chat
        โ
    askAgent (ูุญูู ุงูุฑุณุงูุฉ)
        โ
extractPhasesFromText (ูุณุชุฎุฑุฌ ุงููุฑุงุญู)
        โ
draftTasksForPhase (ูููุฏ ุงูููุงู)
        โ
upsertPhasesAndTasks (ูุญูุธ ูู Firestore)
        โ
   Firestore
```

### 2. ุจููุฉ ุงูุจูุงูุงุช ูู Firestore
```javascript
projects/{projectId}/phases/{phaseId}
{
  id: "uuid",
  title: "ุงูุฅุนุฏุงุฏ ูุงููุตุงุฏูุฉ",
  order: 1,
  status: "open", // ุฃู "in_progress" ุฃู "done" ุฃู "blocked"
  progress: 0, // ูู 0 ุฅูู 100
  createdAt: timestamp,
  updatedAt: timestamp
}

projects/{projectId}/tasks/{taskId}
{
  id: "uuid",
  phaseId: "phase-uuid",
  title: "ุฅุนุฏุงุฏ Firebase Authentication",
  status: "open",
  source: "agent", // ุฃู "user"
  createdAt: timestamp,
  updatedAt: timestamp
}

projects/{projectId}/activity/{logId}
{
  title: "Phases & tasks updated: 3 phases",
  type: "system",
  createdAt: serverTimestamp
}
```

---

## ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุณููุงุฑูู 1: ุฅูุดุงุก ูุฑุงุญู ุจุณูุทุฉ
```
ุงูุชุจ: "ูุดุฑูุน ุจุณูุท ุจูุฑุญูุชูู: 1) ุงูุชุฎุทูุท 2) ุงูุชูููุฐ"

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ 2 phases ูู Firestore
โ Tasks ููู phase
โ Activity log
```

### ุงูุณููุงุฑูู 2: ูุดุฑูุน ูุนูุฏ
```
ุงูุชุจ:
"ูุธุงู ุญุฌุฒ ููุงุนูุฏ ุทุจูุฉ:
1) ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
2) ูุงุฌูุฉ ุงููุณุชุฎุฏู
3) ูุธุงู ุงูุญุฌุฒ
4) ุงูุฅุดุนุงุฑุงุช"

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ 4 phases
โ Tasks ููุฒุนุฉ
โ Activity log ููุตู
```

### ุงูุณููุงุฑูู 3: ููุงุท ูุชูุฑูุฉ
```
ุงูุชุจ:
"โข ุฅุนุฏุงุฏ ุงููุดุฑูุน
โข ุจูุงุก API
โข ุงุฎุชุจุงุฑ"

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ 1 phase ุนุงู
โ 3 tasks ูู ุงูููุงุท
```

---

## ุงูุฅุนุฏุงุฏุงุช ุงููููุฉ

### ููู .env.local
```env
# โ๏ธ ููู ุฌุฏุงู: Mock Mode ูุงุฒู ูููู ูุนุทู
NEXT_PUBLIC_F0_MOCK_MODE=0

# Port
PORT=3030

# Firebase (ูุนุฏ ุจุงููุนู)
NEXT_PUBLIC_FIREBASE_PROJECT_ID=from-zero-84253
```

### Firestore Rules
```javascript
match /projects/{projectId} {
  // ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ...

  // Phase 74: Subcollections
  match /phases/{phaseId} {
    allow read: if isSignedIn();
    allow write: if isSignedIn();
  }
  match /tasks/{taskId} {
    allow read: if isSignedIn();
    allow write: if isSignedIn();
  }
  match /activity/{logId} {
    allow read: if isSignedIn();
    allow write: if isSignedIn();
  }
}
```

---

## ุญู ุงููุดุงูู

### ูุดููุฉ: "Mock Mode is ON"
**ุงูุณุจุจ**: Mock Mode ููุนูู ูู .env.local

**ุงูุญู**:
```bash
# ุนุฏู .env.local
NEXT_PUBLIC_F0_MOCK_MODE=0

# ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ
PORT=3030 pnpm dev
```

### ูุดููุฉ: "Failed to send message"
**ุงูุณุจุจ**: ุฎุทุฃ ูู API ุฃู Firestore

**ุงูุญู**:
1. ุชุญูู ูู logs ุงูุณูุฑูุฑ
2. ุชุฃูุฏ ุฃู Firestore Emulator ุดุบุงู
3. ุดูู console ุงููุชุตูุญ

### ูุดููุฉ: ูููุด phases ุงุชูุดุฃุช
**ุงูุณุจุจ**: ุงูู Parser ูุง ูููุด ุงูุตูุบุฉ

**ุงูุญู**:
- ุงุณุชุฎุฏู ุฃุฑูุงู: `1)` `2)` `3)`
- ุฃู ุงุณุชุฎุฏู `[Phase]`
- ุชุญูู ูู Firestore UI

---

## ุงููููุฏ ุงูุญุงููุฉ

### 1. Agent ูููู
**ุญุงููุงู**: Agent ุจูุนูุฏ ูุชุงุจุฉ ุงูุฑุณุงูุฉ
**ูุทููุจ**: ุฑุจุท ูุน GPT-4 ุฃู Claude
**ุงูููู**: `src/lib/agents/index.ts`

### 2. Parser ุจุณูุท
**ุญุงููุงู**: Regex ุจุณูุท ูู `1)` `2)`
**ูุทููุจ**: NLP ุฃููู
**ุงูููู**: `src/lib/agents/phaseParser.ts`

### 3. ูููุด UI ูููุฑุงุญู
**ุญุงููุงู**: ุจุณ ุดุงุช
**ูุทููุจ**: ููุญุฉ ูุฑุฆูุฉ ูููุฑุงุญู ูุงูููุงู
**ุงููุฑุญูุฉ ุงููุงุฏูุฉ**: Phase 75

---

## ุงูุฎุทูุงุช ุงููุงุฏูุฉ (ุงููุฑุญูุฉ 75)

### ุฃููููุฉ ุนุงููุฉ
1. **ุฑุจุท AI ุญูููู**
   - ุงุณุชุจุฏุงู ุงูู Agent ุงููููู ุจู GPT-4
   - ุฅุถุงูุฉ context ูููุญุงุฏุซุฉ
   - Streaming responses

2. **ูุงุฌูุฉ ุงููุฑุงุญู ูุงูููุงู**
   - ููุญุฉ Phases ูุฑุฆูุฉ
   - ุนุฑุถ Tasks ุจููุท Kanban
   - Drag & drop

3. **ุชุญุฏูุซุงุช ููุฑูุฉ**
   - Subscribe ูุชุบููุฑุงุช Firestore
   - ุชุญุฏูุซ ุงููุงุฌูุฉ ุชููุงุฆูุงู

### ุฃููููุฉ ูุชูุณุทุฉ
1. ุชุญุณูู ุงูู Parser
2. ุฅุฏุงุฑุฉ ุงูููุงู (ุชุนุฏูู/ุญุฐู)
3. Timeline ููุนูููุงุช

---

## ุงูุฃุฏุงุก

### ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ (ูุญูู)
- ุฅุฑุณุงู ุฑุณุงูุฉ: ~100ms
- ูุนุงูุฌุฉ Agent: ~50ms (ูููู)
- ูุฒุงููุฉ Firestore: ~150ms
- **ุงููุฌููุน**: ~300ms

### ุนูููุงุช Firestore
- ููู ุฑุณุงูุฉ: 1 write (activity)
- ููู phase: 1 write
- ููู task: 1 write
- ูููู ูู transaction ูุงุญุฏ

---

## ุงูุฃูุงู

### ุงููุตุงุฏูุฉ
- ูู ุงูุนูููุงุช ุชุญุชุงุฌ `isSignedIn()`
- ุงููุณุชุฎุฏู ูุตู ููุท ููุดุงุฑูุนู
- ุงูู Admin ูุตู ููู ุดูุก

### ุงูุชุญูู ูู ุงูุจูุงูุงุช
- Input sanitization ูู API
- Type checking ูุน TypeScript
- Firestore rules enforcement

---

## ุฑูุงุจุท ูููุฉ

### ุตูุญุงุช ุงูุงุฎุชุจุงุฑ
- ุงููุดุฑูุน: http://localhost:3030/ar/projects/test-project-1
- Firestore UI: http://localhost:4000/firestore

### ุงูุชูุซูู
- ุงูุฅูุฌููุฒู: `PHASE_74_AGENT_CHAT_COMPLETE.md`
- ุงูุนุฑุจู: ูุฐุง ุงูููู
- ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ: `test-agent-chat.sh`

---

## ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅูุฌุงุฒู โ
- ูุธุงู Agent-Driven Development ูุงูู
- ูุงุฌูุฉ ุดุงุช ุชูุงุนููุฉ
- ุงุณุชุฎุฑุงุฌ Phases ู Tasks ุชููุงุฆูุงู
- ูุฒุงููุฉ ูุน Firestore
- ุชุณุฌูู ุงูุนูููุงุช
- ููุงุนุฏ ุงูุฃูุงู
- ุชูุซูู ุดุงูู

### ุงูุฎุทูุฉ ุงูุชุงููุฉ โญ๏ธ
- ุฑุจุท AI ุญูููู (GPT-4/Claude)
- ุจูุงุก ูุงุฌูุฉ ูุฑุฆูุฉ ูููุฑุงุญู
- ุชุญุฏูุซุงุช ููุฑูุฉ

---

**ุงูุญุงูุฉ**: โ ุงููุฑุญูุฉ 74 ููุชููุฉ ูุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ
**ุฑุงุจุท ุงูุงุฎุชุจุงุฑ**: http://localhost:3030/ar/projects/test-project-1

ุฌุฑูุจ ุฏูููุชู! ๐
